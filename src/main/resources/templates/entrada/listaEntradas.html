<html xmlns:th="http://thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	xmlns="http://www.w3.org/1999/xhtml">

<div class="container-fluid" th:fragment="corpo">
	<br> <br>
	<h1>Entradas e saídas</h1>
	<hr>
	<nav class="navbar navbar-expand-lg bg-light">
		<div class="container-fluid">
			<a href="/home"><button class="btn btn-secondary" type="submit">Voltar</button></a>
			<button class="navbar-toggler" type="button" data-bs-toggle="collapse"
				data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
				aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarSupportedContent">
				<ul class="navbar-nav me-auto mb-2 mb-lg-0">
					<br>
					<li class="nav-item dropdown">
						<form class="d-flex" role="switch" th:action="@{/entradas/status}" method="GET">
							<select name="statusEntrada" class="form-select me-1">
								<option value="">Filtro por Status</option>
								<a href="/entradas/listar">
									<option value="">Todas</option>
								</a>
								<option th:each="status : ${stattus}" th:value="${status.name}" th:utext="${status}">
								</option>
							</select>
							<button class="btn btn-secondary" type="submit"><img
									src="/bootstrap-5.1.3-dist/icons/icons/list-ul.svg"></button>
						</form>
					</li>
					<br>
					<li class="nav-item">
						<form class="d-flex" role="search" action="data" method="GET">
							<input class="form-control me-1" name="buscarData" type="date">
							<button class="btn btn-secondary" type="submit"><img
									src="/bootstrap-5.1.3-dist/icons/icons/search.svg"></button>
						</form>
					</li>
					<br>
					<li class="nav-item">
						<a href="/entradas/new"><button class="btn btn-secondary">Adicionar <img
									src="/bootstrap-5.1.3-dist/icons/icons/plus-circle.svg"></button></a>
					</li>
					<br>
					<li class="nav-item">
						<a sec:authorize="hasAuthority('ADMIN')" href="/entradas/export/pdf"><button
								class="btn btn-secondary" type="submit">
								<img src="/bootstrap-5.1.3-dist/icons/icons/download.svg"></button></a>
					</li>
					<br>
				</ul>
				<form class="d-flex" role="search" action="buscar" method="GET">
					<input class="form-control me-1" name="buscarEntrada" type="search" placeholder="Pesquisar"
						aria-label="Search">
					<button class="btn btn-outline-secondary" type="submit"><img
							src="/bootstrap-5.1.3-dist/icons/icons/search.svg"></button>
				</form>
			</div>
		</div>
	</nav>
	<br><br>
	<div class="card">
		<div th:class="${#strings.isEmpty(message)} ? '' : 'card bg-success'">
			<div class="card-header">
				<span th:text="${#strings.isEmpty(message)} ? '' : ${message}"> </span>
			</div>
		</div>
		<div class="card-body">
			<table class="table table-striped table-condensed">
				<thead>
					<tr>
						<th scope="col">ID</th>
						<th scope="col">Porteiro</th>
						<th scope="col">Data e Hora de Entrada</th>
						<th scope="col">Tipo da Entrada</th>
						<th scope="col">Veículo</th>
						<th scope="col">Placa</th>
						<th scope="col">Nome do Motorista</th>
						<th scope="col">Nº do Apartamento</th>
						<th scope="col">Status da Entrada</th>
						<th scope="col">Data e Hora de Saída</th>
						<a sec:authorize="hasAuthority('ADMIN')">
							<th scope="col">Editar</th>
						</a>
						<a sec:authorize="hasAuthority('ADMIN')">
							<th scope="col">Remover</th>
						</a>
						<th scope="col">Finalizar</th>
					</tr>
				</thead>
				<tbody>
					<tr th:each="entrada : ${entradas}">
						<td><span th:text="${entrada.id}"></span></td>
						<td><span th:text="${entrada.nomeUsuario}"></span></td>
						<td><span th:text="${#temporals.format(entrada.horaEntrada, 'dd/MM/yyyy')}"></span>
						</td>
						<td><span th:text="${entrada.tipo}"></span></td>
						<td><span th:text="${entrada.veiculo}"></span></td>
						<td><span th:text="${entrada.placa}"></span></td>
						<td><span th:text="${entrada.nomeMotorista}"></span></td>
						<td><span th:text="${entrada.numeroApt}"></span></td>
						<td><span th:text="${entrada.status}"></span></td>
						<td><span th:text="${#temporals.format(entrada.horaSaida, 'dd/MM/yyyy HH:mm')}"></span>
						</td>
						<a sec:authorize="hasAuthority('ADMIN')">
							<td><a th:href="@{/entradas/editar/{id}(id=${entrada.id})}"><button type="submit"
										class="btn btn-default"><img
											src="/bootstrap-5.1.3-dist/icons/icons/pencil-fill.svg"></button></a>
							</td>
						</a>
						<a sec:authorize="hasAuthority('ADMIN')">
							<!-- Inicio do Deletar entrada -->
							<td>
								<a><button type="button" class="btn btn-default" data-bs-toggle="modal"
										th:attr="data-bs-target='#deletar_'+${entrada.id}"><img
											src="/bootstrap-5.1.3-dist/icons/icons/trash-fill.svg"></button></a>
							</td>
							<!-- Modal -->
							<div class="modal fade" th:id="deletar_+${entrada.id}" tabindex="-1"
								aria-labelledby="exampleModalLabel" aria-hidden="true">
								<div class="modal-dialog">
									<div class="modal-content">
										<div class="modal-header">
											<h5 class="modal-title" id="exampleModalLabel">Excluir</h5>
											<button type="button" class="btn-close" data-bs-dismiss="modal"
												aria-label="Fechar"></button>
										</div>
										<div class="modal-body">
											<p>Deseja realmente excluir essa entrada?</p>
										</div>
										<div class="modal-footer">
											<button type="button" class="btn btn-secondary"
												data-bs-dismiss="modal">Voltar</button>
											<div>
												<a th:href="@{/entradas/excluir/{id}(id=${entrada.id})}"><button
														type="submit" class="btn btn-danger">Confirmar</button></a>
											</div>
										</div>
									</div>
								</div>
							</div>
						</a>
						<td>
							<div class="teste" th:if="${entrada.checaStatus()}">
								<a><button type="button" class="btn btn-default" data-bs-toggle="modal"
										th:attr="data-bs-target='#finalizar_'+${entrada.id}"><img
											src="/bootstrap-5.1.3-dist/icons/icons/check-square-fill.svg"></button>
									<!-- Modal -->
									<div class="modal fade" th:id="finalizar_+${entrada.id}" tabindex="-1"
										aria-labelledby="exampleModalLabel" aria-hidden="true">
										<div class="modal-dialog">
											<div class="modal-content">
												<div class="modal-header">
													<h5 class="modal-title" id="exampleModalLabel">Finalizar</h5>
													<button type="button" class="btn-close" data-bs-dismiss="modal"
														aria-label="Close"></button>
												</div>
												<div class="modal-body">
													<p>Deseja realmente finalizar essa entrada?</p>
												</div>
												<div class="modal-footer">
													<button type="button" class="btn btn-secondary"
														data-bs-dismiss="modal">Voltar</button>
													<a th:href="@{/entradas/finalizar/{id}(id=${entrada.id})}"><button
															type="submit" class="btn btn-primary">Confirmar</button></a>
												</div>
											</div>
										</div>
									</div>
								</a>
							</div>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
	</div>
	<script type="text/javascript" src="../bootstrap-5.1.3-dist/js/bootstrap.bundle.min.js"></script>
</div>

</html>