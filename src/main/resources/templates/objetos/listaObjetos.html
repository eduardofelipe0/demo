<html xmlns:th="http://thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">

<div class="container-fluid" th:fragment="corpo">
	<br> <br>
	<h1>Entrada e Saída de Objetos</h1>
	<hr>
	<nav class="navbar navbar-expand-lg bg-light">
		<div class="container-fluid">
			<a href="/home"><button class="btn btn-secondary" type="submit">Voltar</button></a>
			<button class="navbar-toggler" type="button" data-bs-toggle="collapse"
				data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
				aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarSupportedContent">
				<ul class="navbar-nav me-auto mb-2 mb-lg-0">
					<li class="nav-item dropdown">
						<form class="form" th:action="@{/usuarios/permissao}" method="GET">
							<select name="role" class="form-select">
								<option value="">Busca por permissão</option>
								<a href="/entradas/listar">
									<option value="">TODAS</option>
								</a>
								<option th:each="role : ${roles}" th:value="${role.name}" th:text="${role.name}">
								</option>
							</select>
							<!-- <button type="submit" class="btn btn-secondary"><img
									src="/bootstrap-5.1.3-dist/icons/icons/list-ul.svg"></button> -->
						</form>
					</li>
					<li class="nav-item">
						<a href="/objetos/new"><button class="btn btn-secondary">Adicionar <img
									src="/bootstrap-5.1.3-dist/icons/icons/plus-circle.svg"></button></a>
					</li>
				</ul>
				<form class="d-flex" role="search" action="buscar" method="GET">
					<input class="form-control me-2" name="buscarUsuario" type="search" placeholder="Pesquisar"
						aria-label="Search">
					<button class="btn btn-outline-secondary" type="submit"><img
							src="/bootstrap-5.1.3-dist/icons/icons/search.svg"></button>
				</form>
			</div>
		</div>
	</nav>
	<br><br>
	<div class="card">
		<div th:class="${#strings.isEmpty(message)} ? '' : 'card bg-success'">
			<div class="card-header">
				<span th:text="${#strings.isEmpty(message)} ? '' : ${message}"> </span>
			</div>
		</div>
		<div class="card-body">
			<table class="table table-striped table-condensed">
				<thead>
					<tr>
						<th scope="col">ID</th>
						<th scope="col">Porteiro</th>
						<th scope="col">Data e hora de entrada</th>
						<th scope="col">Funcionário</th>
						<th scope="col">Comentário</th>
						<th scope="col">Tipo de entrada</th>
						<th scope="col">Status</th>
						<th scope="col">Data e hora de saída</th>
						<th scope="col">Editar</th>
						<th scope="col">Excluir</th>
						<th scope="col">Finalizar</th>
					</tr>
				</thead>
				<tbody>
					<tr th:each="objeto : ${objetos}">
						<td><span th:text="${objeto.id}"></span></td>
						<td><span th:text="${objeto.porteiro}"></span></td>
						<td><span th:text="${#temporals.format(objeto.horaDeEntrada, 'dd/MM/yyyy HH:mm')}"></span></td>
						<td><span th:text="${objeto.funcionario}"></span></td>
						<td><span th:text="${objeto.comentario}"></span></td>
						<td><span th:text="${objeto.tipoEntradaObjeto}"></span></td>
						<td><span th:text="${objeto.status}"></span></td>
						<td><span th:text="${#temporals.format(objeto.horaDeSaida, 'dd/MM/yyyy HH:mm')}"></span></td>
						<td><a th:href="@{/objetos/editar/{id}(id=${objeto.id})}"><button type="submit"
									class="btn btn-default"><img
										src="/bootstrap-5.1.3-dist/icons/icons/pencil-fill.svg"></button></a></td>
						<td>
							<a><button type="button" class="btn btn-default" data-bs-toggle="modal"
									th:attr="data-bs-target='#deletar_'+${objeto.id}"><img
										src="/bootstrap-5.1.3-dist/icons/icons/trash-fill.svg"></button>
								<!-- Modal -->
								<div class="modal fade" th:id="deletar_+${objeto.id}" tabindex="-1"
									aria-labelledby="exampleModalLabel" aria-hidden="true">
									<div class="modal-dialog">
										<div class="modal-content">
											<div class="modal-header">
												<h5 class="modal-title" id="exampleModalLabel">Excluir</h5>
												<button type="button" class="btn-close" data-bs-dismiss="modal"
													aria-label="Close"></button>
											</div>
											<div class="modal-body">
												<p>Deseja realmente excluir esse objeto?</p>
											</div>
											<div class="modal-footer">
												<button type="button" class="btn btn-secondary"
													data-bs-dismiss="modal">Voltar</button>
												<div>
													<a th:href="@{/objetos/excluir/{id}(id=${objeto.id})}"><button
															type="submit" class="btn btn-danger">Confirmar</button></a>
												</div>
											</div>
										</div>
									</div>
								</div>
							</a>
						</td>
						<td>
							<a><button type="button" class="btn btn-default" data-bs-toggle="modal"
									th:attr="data-bs-target='#finalizar_'+${objeto.id}"><img
										src="/bootstrap-5.1.3-dist/icons/icons/check-square-fill.svg"></button>
								<!-- Modal -->
								<div class="modal fade" th:id="finalizar_+${objeto.id}" tabindex="-1"
									aria-labelledby="exampleModalLabel" aria-hidden="true">
									<div class="modal-dialog">
										<div class="modal-content">
											<div class="modal-header">
												<h5 class="modal-title" id="exampleModalLabel">Finalizar</h5>
												<button type="button" class="btn-close" data-bs-dismiss="modal"
													aria-label="Close"></button>
											</div>
											<div class="modal-body">
												<p>Deseja realmente finalizar essa entrada?</p>
											</div>
											<div class="modal-footer">
												<button type="button" class="btn btn-secondary"
													data-bs-dismiss="modal">Voltar</button>
												<a th:href="@{/objetos/finalizar/{id}(id=${objeto.id})}"><button
														type="submit" class="btn btn-primary">Confirmar</button></a>
											</div>
										</div>
									</div>
								</div>
							</a>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<script type="text/javascript" src="../bootstrap-5.1.3-dist/js/bootstrap.bundle.min.js"></script>
	</div>
</div>

</html>